<?php

//////////////////////////////////////////////////////////////////////////////80
// TextMode Controller
//////////////////////////////////////////////////////////////////////////////80
// Copyright (c) Atheos & Liam Siira (Atheos.io), distributed as-is and without
// warranty under the modified License: MIT - Hippocratic 1.2: firstdonoharm.dev
// See [root]/license.md for more. This information must remain intact.
//////////////////////////////////////////////////////////////////////////////80
// Authors: Codiad Team, @ccvca, Atheos Team, @hlsiira
//////////////////////////////////////////////////////////////////////////////80

require_once "../../common.php";
require_once "class.textmode.php";

//////////////////////////////////////////////////////////////////
// Verify Session or Key
//////////////////////////////////////////////////////////////////
Common::checkSession();

$action = Common::data("action");

if (!$action) {
	Common::sendJSON("E401m"); die;
}

$TextMode = new TextMode();

switch ($action) {
	//////////////////////////////////////////////////////////////////
	// Set custom text modes
	//////////////////////////////////////////////////////////////////
	case 'saveExtensionMap':
		if (Common::checkAccess("configure")) {
			$map = Common::data('map');
			if (!is_array($map)) {
				Common::sendJSON("E403i", "Map"); die;
			}

			$TextMode->saveExtensionMap($map);
		} else {
			Common::sendJSON("E430u"); die;
		}
		break;

	//////////////////////////////////////////////////////////////////
	// Get text modes
	//////////////////////////////////////////////////////////////////
	case 'loadExtensionMap':
		$TextMode->loadExtensionMap();
		break;
	default:
		Common::sendJSON("E401i"); die;
		break;
}